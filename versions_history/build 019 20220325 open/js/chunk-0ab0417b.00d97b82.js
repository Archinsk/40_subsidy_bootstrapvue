(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ab0417b"],{"8f8b":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("section",{staticClass:"applications"},[a("div",{staticClass:"measures__wrapper"},[a("h4",{staticClass:"primary-title text-center"},[e._v(" Заявления "),a("span",{class:"badge badge-"+e.theme},[e._v(e._s(e.apps.totalElements))])]),a("ApplicationsCardsList",{attrs:{"apps-cards-list":e.apps,"items-total":e.itemsTotal,page:e.page,"page-size":e.pageSize,"items-per-page":e.itemsPerPage,theme:e.theme},on:{"change-page-size":function(t){return e.changePageSize(t)},"change-page":e.changePage,"get-app-form":function(t){return e.getStartForm(t)}}})],1)]),a("b-modal",{attrs:{id:"edit-app",title:e.appForm.form.name,size:"xl","hide-footer":"","no-stacking":""},on:{close:e.cleanAppForm}},[e.isResponse?[e.isAlertVisible?a("div",{staticClass:"alert alert-success",attrs:{role:"alert"}},[e._v(" "+e._s(e.successComment)+" ")]):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col-10"},[a("Form",{ref:"vueForm",attrs:{form:e.appForm.form.scheme,submission:e.appForm,options:{readOnly:!e.appForm.active}}})],1),e.appForm.form.actions&&e.appForm.form.actions.length>0?a("div",{staticClass:"col-2"},[e._l(e.appForm.form.actions,(function(t){return[e.appForm.active||t.alwaysActive?[t.backAction?a("button",{key:t.id,staticClass:"btn btn-block btn-primary",attrs:{type:"button"},on:{click:function(a){return e.invokeAction(t.id,!0)}}},[e._v(e._s(t.name))]):a("button",{key:t.id,staticClass:"btn btn-block btn-primary",attrs:{type:"button"},on:{click:function(a){return e.invokeAction(t.id)}}},[e._v(" "+e._s(t.name)+" ")])]:e._e()]}))],2):e._e()])]:e.isLoading?[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body text-center"},[a("div",{staticClass:"spinner-border text-primary",attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[e._v("Loading...")])]),a("div",[e._v(e._s(e.loadingComment))])])])]:e._e()],2)],1)},s=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.appsCardsList.content,(function(t,i){return a("ApplicationsCardsListItem",{key:i?t.id+"-"+i:t.id,attrs:{application:t,index:i,theme:e.theme},on:{"get-app-form":function(a){return e.$emit("get-app-form",t.id)}}})})),a("Pagination",{directives:[{name:"show",rawName:"v-show",value:e.itemsTotal>e.pageSize,expression:"itemsTotal > pageSize"}],attrs:{"items-total":e.itemsTotal,page:e.page,"page-size":e.pageSize,"items-per-page":e.itemsPerPage,theme:e.theme},on:{"change-page-size":function(t){return e.$emit("change-page-size",t)},"change-page":function(t){return e.$emit("change-page",t)}}})],2)},o=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card request-card"},[a("div",{staticClass:"card-body d-flex justify-content-between align-items-center"},[a("h5",{staticClass:"card-title mb-0"},[a("span",{class:"badge badge-"+e.theme+" mr-2"},[e._v("№"+e._s(e.application.id))]),e._v(" "+e._s(e.application?e.application.servName:"Наименование меры поддержки")+" ")]),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.edit-app",modifiers:{"edit-app":!0}}],attrs:{variant:"outline-"+e.theme},on:{click:function(t){return e.$emit("get-app-form")}}},[e._v(" Посмотреть заявку ")])],1),a("div",{staticClass:"card-footer bg-transparent"},[a("p",[e._v("Текущий статус: "+e._s(e.application.status))]),a("p",[e._v("Дата подачи: 01.01.2022")]),a("p",[e._v("Статус обновлен: 19.01.2022")])])])},c=[],p={name:"ApplicationsCardsListItem",props:["application","index","theme"],data:function(){return{}},computed:{}},l=p,g=a("2877"),m=Object(g["a"])(l,r,c,!1,null,null,null),u=m.exports,d=a("cbb7"),h={name:"ApplicationsCardsList",components:{ApplicationsCardsListItem:u,Pagination:d["a"]},props:["appsCardsList","itemsTotal","page","pageSize","itemsPerPage","theme"]},f=h,v=Object(g["a"])(f,n,o,!1,null,null,null),_=v.exports,b=a("5b48"),P=a("bc3a"),C=a.n(P),F={name:"Applications",components:{ApplicationsCardsList:_,Form:b["Form"]},props:["theme"],data:function(){return{url:"https://open-newtemplate.isands.ru/api/",apps:[],itemsTotal:0,page:1,pageSize:10,itemsPerPage:[10,25,50],appForm:{active:!1,data:{},form:{actions:[],id:0,modelId:0,scheme:{}},id:0,orderId:"",status:""},isLoading:!1,loadingComment:"Загрузка заявления",successComment:"Заявление успешно загружено!",isResponse:!1,isAlertVisible:!1,isValidFormData:!1,isFirstLoad:!0}},methods:{getApps:function(e,t){var a=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];C.a.get(this.url+"app/get-apps?pageNum="+(e-1)+"&pageSize="+t+"&sortCol="+i+"&sortDesc="+s+"&active="+n).then((function(e){a.apps=e.data,a.itemsTotal=e.data.totalElements,console.log("Список заявлений"),console.log(a.apps)}))},getStartForm:function(e){this.isResponse=!1,this.isLoading=!0,this.loadingComment="Загрузка формы заявления",setTimeout(this.getForm,1e3,e)},getForm:function(e){var t=this;C.a.get(this.url+"app/get-appData?id="+e).then((function(e){console.log("Стартовая форма"),console.log(e);var a=e.data;a.data=JSON.parse(a.data),a.form.scheme=JSON.parse(a.form.scheme),t.appForm=a})).then((function(){t.isResponse=!0,t.isLoading=!1,t.isAlertVisible=!0,setTimeout(t.hideAlert,3e3)}))},hideAlert:function(){this.isAlertVisible=!1},validateForm:function(){return this.$refs.vueForm.formio.checkValidity(this.$refs.vueForm.formio.submission.data)},invokeAction:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("Выполнение действия"),this.isFirstLoad=!1,this.isValidFormData=this.validateForm(),console.log("Валидность формы:"+this.isValidFormData),this.isValidFormData?(this.loadingComment="Отправка данных заявления",this.isResponse=!1,this.isLoading=!0,setTimeout(this.invoke,1e3,e,t)):this.$refs.vueForm.formio.submit()},invoke:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={actionId:e,userId:13,appId:this.appForm.id,data:JSON.stringify(this.appForm.data)};C.a.post(this.url+"app/action-invoke",i).then((function(e){if(console.log("Ответ на экшн"),console.log(e),e.data.responseObject){var i=JSON.parse(e.data.responseObject);console.log("Объект файла"),console.log(i);var s=document.createElement("a");s.setAttribute("download",i.fileName),s.setAttribute("href","data:application/octet-stream;base64,"+i.fileData),s.click()}else a?t.cleanAppForm():t.getNextForm(e)})).then((function(){t.isResponse=!0,t.isLoading=!1,t.isAlertVisible=!0,t.isFirstLoad=!0,setTimeout(t.hideAlert,3e3)}))},getNextForm:function(e){console.log("Следующая форма"),console.log(e);var t=e.data.applicationDTO;t.data=JSON.parse(t.data),t.form.scheme=JSON.parse(t.form.scheme),this.appForm=t,this.successComment="Заявление отправлено!"},cleanAppForm:function(){this.$bvModal.hide("edit-app"),this.isLoading=!1,this.loadingComment="Загрузка формы заявления",this.successComment="Форма заявления успешно загружена!",this.isResponse=!0,this.isAlertVisible=!0,this.isValidFormData=!1,this.isFirstLoad=!0},changePageSize:function(e){this.page=e[0],this.pageSize=e[1],this.getApps(this.page,this.pageSize),this.scrollToTop()},changePage:function(e){this.page=e,this.getApps(this.page,this.pageSize),this.scrollToTop()},scrollToTop:function(){window.scrollTo(0,0)}},mounted:function(){this.getApps(this.page,this.pageSize)}},k=F,z=(a("fa3a"),Object(g["a"])(k,i,s,!1,null,null,null));t["default"]=z.exports},"96a6":function(e,t,a){},cbb7:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paginator d-flex justify-content-between align-items-center"},[a("PaginationItemsPerPage",{attrs:{"items-per-page":e.itemsPerPage,"page-size":e.pageSize,theme:e.theme},on:{"change-page-size":function(t){return e.changePageSize(t)}}}),a("div",{staticClass:"paginator__items-of-total"},[e._v(" "+e._s(e.pageSize*(e.page-1)+1)+" - "+e._s(e.page===e.pages?e.itemsTotal:e.pageSize*e.page)+" из "+e._s(e.itemsTotal)+" ")]),e.itemsTotal>e.pageSize?a("PaginationPageSelector",{attrs:{pages:e.pages,"active-page":e.page,theme:e.theme},on:{"change-page":function(t){return e.$emit("change-page",t)}}}):e._e()],1)},s=[],n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paginator__items-per-page d-none d-lg-block"},e._l(e.itemsPerPage,(function(t){return a("button",{key:t,class:"page-size btn btn-"+e.theme,attrs:{type:"button"},on:{click:function(a){return e.$emit("change-page-size",t)}}},[e._v(" "+e._s(t)+" ")])})),0)},o=[],r={name:"PaginationItemsPerPage",props:["itemsPerPage","pageSize","theme"]},c=r,p=a("2877"),l=Object(p["a"])(c,n,o,!1,null,null,null),g=l.exports,m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paginator__page-selector"},[a("nav",{attrs:{"aria-label":"Page navigation example"}},[a("ul",{staticClass:"pagination justify-content-center"},[e.activePage>1?a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Предыдущая"},on:{click:function(t){return t.preventDefault(),e.$emit("change-page",--e.activePage)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("«")])])]):e._e(),e.activePage>2?a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("change-page",1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("1")])])]):e._e(),e.activePage>3?[e.activePage>4?a("li",{staticClass:"page-item disabled"},[e._m(0)]):a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("change-page",2)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("2")])])])]:e._e(),e._l(e.pages,(function(t){return[t>=e.activePage-1&&t<=e.activePage+1?a("li",{key:t,staticClass:"page-item",class:{active:t===e.activePage}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),e.$emit("change-page",t)}}},[e._v(e._s(t))])]):e._e()]})),e.activePage<e.pages-2?[e.activePage<e.pages-3?a("li",{staticClass:"page-item disabled"},[e._m(1)]):a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("change-page",e.pages-1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v(e._s(e.pages-1))])])])]:e._e(),e.activePage<e.pages-1?a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$emit("change-page",e.pages)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v(e._s(e.pages))])])]):e._e(),e.activePage<e.pages?a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Следующая"},on:{click:function(t){return t.preventDefault(),e.$emit("change-page",++e.activePage)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("»")])])]):e._e()],2)])])},u=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("…")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a",{staticClass:"page-link",attrs:{href:"#"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("…")])])}],d={name:"PaginationPageSelector",props:["pages","activePage","theme"]},h=d,f=Object(p["a"])(h,m,u,!1,null,null,null),v=f.exports,_={name:"Pagination",components:{PaginationItemsPerPage:g,PaginationPageSelector:v},props:["itemsTotal","page","pageSize","itemsPerPage","theme"],methods:{changePageSize:function(e){var t=this.countFirstItemNumberOnPage(this.pageSize,this.page),a=this.countNewPage(t,e),i=[];i.push(a),i.push(e),this.$emit("change-page-size",i)},countFirstItemNumberOnPage:function(e,t){return e*(t-1)+1},countNewPage:function(e,t){return Math.ceil(e/t)}},computed:{pages:function(){return Math.ceil(this.itemsTotal/this.pageSize)}}},b=_,P=Object(p["a"])(b,i,s,!1,null,null,null);t["a"]=P.exports},fa3a:function(e,t,a){"use strict";a("96a6")}}]);
//# sourceMappingURL=chunk-0ab0417b.00d97b82.js.map